<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>éšŠå“¡é€šè¨ŠéŒ„(å…¨éšŠæŸ¥è©¢ç‰ˆ)</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        :root { --primary-color: #2c3e50; }
        body { background-color: #f4f7f6; font-family: sans-serif; }
        .navbar { background-color: var(--primary-color); color: white; }
        .sticky-search { position: sticky; top: 0; z-index: 1020; background: #f4f7f6; padding: 15px 0; }
        .nav-pills .nav-link { background: #fff; margin: 2px; border: 1px solid #ddd; color: #555; }
        .nav-pills .nav-link.active { background-color: #0d6efd; color: white; }
        .contact-card { border-radius: 10px; border: none; }
        .badge-team { font-size: 0.7rem; padding: 4px 8px; }
        .phone-link { text-decoration: none; font-size: 1.1rem; font-weight: bold; }
    </style>
</head>
<body>

<nav class="navbar shadow-sm">
    <div class="container-fluid justify-content-center">
        <span class="navbar-brand mb-0 h1 text-white">2026 éšŠå“¡åå–®å…¨ç³»çµ±</span>
    </div>
</nav>

<div class="container">
    <div class="sticky-search">
        <input type="text" id="searchInput" class="form-control form-control-lg shadow-sm" placeholder="ğŸ” è¼¸å…¥å§“åã€é›»è©±å¯è·¨éšŠæœå°‹...">
    </div>

    <ul class="nav nav-pills nav-fill mb-3" id="sheetTabs">
        <li class="nav-item"><a class="nav-link active" data-team="all" href="#">å…¨éƒ¨</a></li>
        <li class="nav-item"><a class="nav-link" data-team="å”åŠ›ä¸€" href="#">å”åŠ›ä¸€</a></li>
        <li class="nav-item"><a class="nav-link" data-team="å”åŠ›äºŒ" href="#">å”åŠ›äºŒ</a></li>
        <li class="nav-item"><a class="nav-link" data-team="å”åŠ›ä¸‰" href="#">å”åŠ›ä¸‰</a></li>
        <li class="nav-item"><a class="nav-link" data-team="å”åŠ›å››" href="#">å”åŠ›å››</a></li>
    </ul>

    <div id="status" class="text-center text-muted small mb-2">è³‡æ–™è¼‰å…¥ä¸­...</div>
    <div id="contactList" class="row g-2"></div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    let allContacts = []; // å„²å­˜æ‰€æœ‰éšŠä¼è³‡æ–™
    let currentFiltered = []; // å„²å­˜ç›®å‰é¡¯ç¤ºçš„è³‡æ–™

    // 1. åˆå§‹åŒ–ï¼šåŒæ™‚æŠ“å– 4 å€‹æª”æ¡ˆ
    $(document).ready(function() {
        const files = [
            { name: 'å”åŠ›ä¸€', url: 'data1.json' },
            { name: 'å”åŠ›äºŒ', url: 'data2.json' },
            { name: 'å”åŠ›ä¸‰', url: 'data3.json' },
            { name: 'å”åŠ›å››', url: 'data4.json' }
        ];

        // ä½¿ç”¨ Promise.all åŒæ™‚è®€å–
        Promise.all(files.map(f => 
            fetch(`./data/${f.url}`).then(res => res.json()).then(data => {
                // ç‚ºæ¯ä¸€ç­†è³‡æ–™è²¼ä¸Šã€ŒéšŠä¼æ¨™ç±¤ã€
                return data.map(item => ({ ...item, teamName: f.name }));
            })
        ))
        .then(results => {
            allContacts = results.flat(); // åˆä½µé™£åˆ—
            $('#status').text(`å…±è¼‰å…¥ ${allContacts.length} ç­†è³‡æ–™`);
            renderData(allContacts);
        })
        .catch(err => {
            $('#status').html('<span class="text-danger">è¼‰å…¥å¤±æ•—ï¼Œè«‹ç¢ºèª data è³‡æ–™å¤¾æª”æ¡ˆæ˜¯å¦å­˜åœ¨</span>');
        });
    });

    // 2. æœå°‹èˆ‡ç¯©é¸é‚è¼¯
    function filterAndRender() {
        const term = $('#searchInput').val().trim().toLowerCase();
        const activeTeam = $('#sheetTabs .active').data('team');

        let result = allContacts;

        // å…ˆç¯©é¸éšŠä¼
        if (activeTeam !== 'all') {
            result = result.filter(item => item.teamName === activeTeam);
        }

        // å†ç¯©é¸é—œéµå­—
        if (term) {
            result = result.filter(item => 
                item.name.toLowerCase().includes(term) || 
                item.mobile_phone.includes(term) ||
                item.home_phone.includes(term)
            );
        }

        renderData(result);
    }

    // 3. æ¸²æŸ“ç•«é¢
    function renderData(data) {
        const container = $('#contactList');
        container.empty();

        if (data.length === 0) {
            container.html('<div class="col-12 text-center py-5 text-muted">æ‰¾ä¸åˆ°ç›¸ç¬¦çš„è³‡æ–™</div>');
            return;
        }

        data.forEach(item => {
            container.append(`
                <div class="col-12 col-md-6">
                    <div class="card contact-card shadow-sm">
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-start">
                                <h5 class="card-title mb-1">${item.name}</h5>
                                <span class="badge bg-secondary badge-team">${item.teamName}</span>
                            </div>
                            <div class="mt-2">
                                <div class="mb-1">
                                    <small class="text-muted">æ‰‹æ©Ÿï¼š</small>
                                    <a href="tel:${item.mobile_phone}" class="phone-link">${item.mobile_phone || 'ç„¡'}</a>
                                </div>
                                <div>
                                    <small class="text-muted">ä½å®…ï¼š</small>
                                    <span class="text-dark">${item.home_phone || '---'}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `);
        });
    }

    // äº‹ä»¶ç›£è½
    $('#searchInput').on('input', filterAndRender);
    $('#sheetTabs .nav-link').on('click', function(e) {
        e.preventDefault();
        $('#sheetTabs .nav-link').removeClass('active');
        $(this).addClass('active');
        filterAndRender();
    });
</script>
</body>
</html>
