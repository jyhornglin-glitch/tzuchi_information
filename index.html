<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>éšŠå“¡é€šè¨ŠéŒ„æŸ¥è©¢ç³»çµ±</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        :root { --primary-color: #2c3e50; }
        body { background-color: #f4f7f6; font-family: -apple-system, sans-serif; }
        .navbar { background-color: var(--primary-color); color: white; margin-bottom: 0; }
        .sticky-search { 
            position: sticky; 
            top: 0; 
            z-index: 1020; 
            background: #f4f7f6; 
            padding: 15px 0; 
            border-bottom: 1px solid #ddd;
        }
        .nav-pills .nav-link { background: #fff; margin: 2px; border: 1px solid #ddd; color: #555; }
        .nav-pills .nav-link.active { background-color: #0d6efd; color: white; border-color: #0d6efd; }
        .contact-card { 
            border-radius: 12px; 
            border: none; 
            transition: transform 0.1s;
        }
        .contact-card:active { transform: scale(0.98); }
        .title-badge { font-size: 0.8rem; vertical-align: middle; }
        .team-label { font-size: 0.7rem; color: #888; }
        .phone-link { text-decoration: none; font-size: 1.15rem; font-weight: bold; color: #0d6efd; }
        .home-phone { color: #666; font-size: 0.95rem; }
    </style>
</head>
<body>

<nav class="navbar shadow-sm">
    <div class="container-fluid justify-content-center">
        <span class="navbar-brand mb-0 h1 text-white">2026 éšŠå“¡åå–®</span>
    </div>
</nav>

<div class="container">
    <div class="sticky-search">
        <input type="text" id="searchInput" class="form-control form-control-lg shadow-sm mb-3" placeholder="ğŸ” è¼¸å…¥å§“åã€è·ç¨±æˆ–é›»è©±...">
        
        <ul class="nav nav-pills nav-fill" id="sheetTabs">
            <li class="nav-item"><a class="nav-link active" data-team="all" href="#">å…¨éƒ¨</a></li>
            <li class="nav-item"><a class="nav-link" data-team="å”åŠ›ä¸€" href="#">å”åŠ›ä¸€</a></li>
            <li class="nav-item"><a class="nav-link" data-team="å”åŠ›äºŒ" href="#">å”åŠ›äºŒ</a></li>
            <li class="nav-item"><a class="nav-link" data-team="å”åŠ›ä¸‰" href="#">å”åŠ›ä¸‰</a></li>
            <li class="nav-item"><a class="nav-link" data-team="å”åŠ›å››" href="#">å”åŠ›å››</a></li>
        </ul>
        <div id="status" class="text-center small text-muted mt-2">è³‡æ–™åŒæ­¥ä¸­...</div>
    </div>

    <div id="contactList" class="row g-2 mt-2">
        </div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    let allContacts = [];

    // 1. åŒæ™‚è®€å–å››å€‹ JSON æª”æ¡ˆ
    $(document).ready(function() {
        const fileConfig = [
            { label: 'å”åŠ›ä¸€', url: 'data1.json' },
            { label: 'å”åŠ›äºŒ', url: 'data2.json' },
            { label: 'å”åŠ›ä¸‰', url: 'data3.json' },
            { label: 'å”åŠ›å››', url: 'data4.json' }
        ];

        Promise.all(fileConfig.map(file => 
            fetch(`./data/${file.url}?v=${new Date().getTime()}`)
                .then(res => res.json())
                .then(data => data.map(item => ({ ...item, teamName: file.label })))
                .catch(() => []) // è‹¥æª”æ¡ˆä¸å­˜åœ¨å‰‡å›å‚³ç©ºé™£åˆ—
        ))
        .then(results => {
            allContacts = results.flat();
            $('#status').text(`å·²è¼‰å…¥ ${allContacts.length} ä½æˆå“¡`);
            filterAndRender();
        })
        .catch(err => {
            $('#status').text('è¼‰å…¥å¤±æ•—ï¼Œè«‹ç¢ºèªè³‡æ–™å¤¾çµæ§‹');
        });
    });

    // 2. æœå°‹èˆ‡ç¯©é¸æ ¸å¿ƒé‚è¼¯
    function filterAndRender() {
        const term = $('#searchInput').val().trim().toLowerCase();
        const activeTeam = $('#sheetTabs .active').data('team');

        let filtered = allContacts;

        // éšŠä¼éæ¿¾
        if (activeTeam !== 'all') {
            filtered = filtered.filter(item => item.teamName === activeTeam);
        }

        // é—œéµå­—éæ¿¾ (æ”¯æ´å§“å, è·ç¨±, æ‰‹æ©Ÿ, ä½å®…é›»è©±)
        if (term) {
            filtered = filtered.filter(item => 
                (item.name && item.name.toLowerCase().includes(term)) || 
                (item.title && item.title.toLowerCase().includes(term)) ||
                (item.mobile && item.mobile.includes(term)) ||
                (item.home_phone && item.home_phone.includes(term))
            );
        }

        render(filtered);
    }

    // 3. ç•«é¢å½©ç¾
    function render(data) {
        const list = $('#contactList');
        list.empty();

        if (data.length === 0) {
            list.html('<div class="col-12 text-center py-5 text-muted">ç„¡ç›¸ç¬¦çµæœ</div>');
            return;
        }

        data.forEach(item => {
            // è·ç¨±æ¨™ç±¤ (å¦‚æœæœ‰è·ç¨±æ‰é¡¯ç¤ºç´…è‰²æ¨™ç±¤)
            const titleHtml = item.title ? `<span class="badge bg-danger ms-2 title-badge">${item.title}</span>` : '';
            
            list.append(`
                <div class="col-12 col-md-6">
                    <div class="card contact-card shadow-sm h-100">
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-center">
                                <h5 class="mb-1 fw-bold">${item.name}${titleHtml}</h5>
                                <span class="team-label">${item.teamName}</span>
                            </div>
                            <hr class="my-2 opacity-25">
                            <div class="row align-items-center">
                                <div class="col-7">
                                    <small class="text-muted d-block">æ‰‹æ©Ÿ</small>
                                    <a href="tel:${item.mobile}" class="phone-link">ğŸ“± ${item.mobile || 'ç„¡'}</a>
                                </div>
                                <div class="col-5">
                                    <small class="text-muted d-block">ä½å®…</small>
                                    <span class="home-phone">ğŸ  ${item.home_phone || '---'}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `);
        });
    }

    // äº‹ä»¶ç¶å®š
    $('#searchInput').on('input', filterAndRender);
    $('#sheetTabs .nav-link').on('click', function(e) {
        e.preventDefault();
        $('#sheetTabs .nav-link').removeClass('active');
        $(this).addClass('active');
        filterAndRender();
    });
</script>
</body>
</html>
